<!-- Screen: Portfolio Detail -->
<div id="screen-portfolio-detail" class="screen" data-domain="portfolio">
    <div class="screen-body">
        <header class="header">
            <button class="back-btn" id="detail-back-btn">←</button>
            <h2 id="detail-title">포트폴리오 상세</h2>
            <div class="header-actions">
                <button class="icon-btn" id="detail-menu-btn">☰</button>
            </div>
        </header>

        <!-- Banner Color Strip (DB: portfolios.banner_color) -->
        <div class="portfolio-banner" id="detail-banner" style="background: var(--gradient-primary);"></div>

        <!-- Summary Grid -->
        <div class="detail-summary">
            <div class="summary-grid">
                <div class="summary-item">
                    <span class="item-label">총 평가금액</span>
                    <span class="item-value large" id="detail-total-val">₩32,450,000</span>
                </div>
                <div class="summary-item">
                    <span class="item-label">현금 비중 (<span id="detail-cash-ratio">5</span>%)</span>
                    <span class="item-value" id="detail-cash-val">₩1,622,500</span>
                </div>
                <div class="summary-item">
                    <span class="item-label">수익금</span>
                    <span class="item-value positive" id="detail-return-val">+₩2,200,000</span>
                </div>
                <div class="summary-item">
                    <span class="item-label">수익률</span>
                    <span class="item-value positive" id="detail-return-rate">+7.27%</span>
                </div>
            </div>
        </div>

        <div class="stocks-section">
            <div class="section-header">
                <h3>보유 종목</h3>
                <div class="stock-meta">
                    <span class="stock-count" id="detail-stock-count">5종목</span>
                    <span class="ratio-sum" id="detail-ratio-sum">비율합계 100%</span>
                </div>
            </div>

            <!-- Rebalance Insight (Conditional) -->
            <div class="rebalance-insight" id="detail-rebalance-insight">
                <span class="insight-icon">⚠️</span>
                <div class="insight-text">
                    <span class="insight-title">리밸런싱 필요</span>
                    <span class="insight-detail" id="detail-insight-msg">삼성전자 +17% 초과 · 카카오 -20% 미달</span>
                </div>
                <button class="insight-btn" id="detail-rebalance-btn">분석 →</button>
            </div>

            <!-- Stock List -->
            <div class="stocks-cards" id="detail-stock-list">
                <!-- Static Dummy Data -->
                <div class="stock-card">
                    <div class="stock-card-header">
                        <div class="stock-info">
                            <span class="stock-name">삼성전자</span>
                            <span class="stock-code">005930</span>
                        </div>
                        <div class="stock-value-info">
                            <span class="value-main">₩11,357,500</span>
                            <span class="value-change positive">+5.2%</span>
                        </div>
                        <button class="delete-stock-btn">×</button>
                    </div>
                    <div class="stock-card-ratio">
                        <div class="ratio-labels">
                            <span class="ratio-current-label">현재 35%</span>
                            <span class="ratio-target-label">목표 30%</span>
                        </div>
                        <div class="deviation-bar">
                            <div class="deviation-track">
                                <div class="deviation-center"></div>
                                <div class="deviation-fill over" style="width: 34%;"></div>
                            </div>
                        </div>
                        <div class="deviation-tag sell">+17% 초과</div>
                    </div>
                </div>

                <div class="stock-card">
                    <div class="stock-card-header">
                        <div class="stock-info">
                            <span class="stock-name">SK하이닉스</span>
                            <span class="stock-code">000660</span>
                        </div>
                        <div class="stock-value-info">
                            <span class="value-main">₩8,112,500</span>
                            <span class="value-change positive">+8.1%</span>
                        </div>
                        <button class="delete-stock-btn">×</button>
                    </div>
                    <div class="stock-card-ratio">
                        <div class="ratio-labels">
                            <span class="ratio-current-label">현재 25%</span>
                            <span class="ratio-target-label">목표 25%</span>
                        </div>
                        <div class="deviation-bar">
                            <div class="deviation-track">
                                <div class="deviation-center"></div>
                            </div>
                        </div>
                        <div class="deviation-tag ok">적정 범위 ✓</div>
                    </div>
                </div>

                <div class="stock-card">
                    <div class="stock-card-header">
                        <div class="stock-info">
                            <span class="stock-name">NAVER</span>
                            <span class="stock-code">035420</span>
                        </div>
                        <div class="stock-value-info">
                            <span class="value-main">₩6,490,000</span>
                            <span class="value-change positive">+3.7%</span>
                        </div>
                        <button class="delete-stock-btn">×</button>
                    </div>
                    <div class="stock-card-ratio">
                        <div class="ratio-labels">
                            <span class="ratio-current-label">현재 20%</span>
                            <span class="ratio-target-label">목표 20%</span>
                        </div>
                        <div class="deviation-bar">
                            <div class="deviation-track">
                                <div class="deviation-center"></div>
                            </div>
                        </div>
                        <div class="deviation-tag ok">적정 범위 ✓</div>
                    </div>
                </div>

                <div class="stock-card">
                    <div class="stock-card-header">
                        <div class="stock-info">
                            <span class="stock-name">카카오</span>
                            <span class="stock-code">035720</span>
                        </div>
                        <div class="stock-value-info">
                            <span class="value-main">₩3,894,000</span>
                            <span class="value-change negative">-4.3%</span>
                        </div>
                        <button class="delete-stock-btn">×</button>
                    </div>
                    <div class="stock-card-ratio">
                        <div class="ratio-labels">
                            <span class="ratio-current-label">현재 12%</span>
                            <span class="ratio-target-label">목표 15%</span>
                        </div>
                        <div class="deviation-bar">
                            <div class="deviation-track">
                                <div class="deviation-center"></div>
                                <div class="deviation-fill under" style="width: 50%;"></div>
                            </div>
                        </div>
                        <div class="deviation-tag buy">-20% 미달</div>
                    </div>
                </div>

                <div class="stock-card">
                    <div class="stock-card-header">
                        <div class="stock-info">
                            <span class="stock-name">LG에너지솔루션</span>
                            <span class="stock-code">373220</span>
                        </div>
                        <div class="stock-value-info">
                            <span class="value-main">₩2,596,000</span>
                            <span class="value-change positive">+12.5%</span>
                        </div>
                        <button class="delete-stock-btn">×</button>
                    </div>
                    <div class="stock-card-ratio">
                        <div class="ratio-labels">
                            <span class="ratio-current-label">현재 8%</span>
                            <span class="ratio-target-label">목표 10%</span>
                        </div>
                        <div class="deviation-bar">
                            <div class="deviation-track">
                                <div class="deviation-center"></div>
                                <div class="deviation-fill under" style="width: 40%;"></div>
                            </div>
                        </div>
                        <div class="deviation-tag buy">-20% 미달</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Empty State -->
        <div id="detail-empty-state" class="empty-state detail-empty" style="display: none;">
            <div class="empty-icon">📈</div>
            <h3 class="empty-title">아직 종목이 없어요</h3>
            <p class="empty-desc">첫 종목을 추가해보세요!</p>
            <button class="empty-btn" id="detail-add-stock-empty-btn">+ 종목 추가</button>
        </div>
    </div>

    <!-- Dropdown Menu -->
    <div id="detail-dropdown-menu" class="dropdown-menu" style="display: none;">
        <div class="dropdown-item" id="menu-threshold">
            <span class="dropdown-icon">⚙️</span>
            <span>임계값 설정</span>
        </div>
        <div class="dropdown-item" id="menu-notification">
            <span class="dropdown-icon">🔔</span>
            <span>알림 설정</span>
        </div>
        <div class="dropdown-item" id="menu-edit">
            <span class="dropdown-icon">✏️</span>
            <span>편집</span>
        </div>
    </div>

    <!-- Threshold Setting Bottom Sheet -->
    <div id="threshold-modal" class="bottom-sheet-overlay" style="display: none;">
        <div class="bottom-sheet">
            <div class="bottom-sheet-handle"></div>
            <div class="bottom-sheet-header">
                <h3>임계값 설정</h3>
                <button class="close-btn" id="threshold-close-btn">×</button>
            </div>
            <div class="bottom-sheet-body">
                <p style="color: var(--text-secondary); font-size: 14px; margin-bottom: 24px;">
                    목표 비율과 현재 비율의 차이가 이 값을 초과하면 리밸런싱 알림을 보냅니다.
                </p>
                <div class="threshold-options">
                    <div class="radio-option" data-value="3">
                        <input type="radio" name="threshold" id="threshold-3" value="3">
                        <div style="flex: 1;">
                            <div class="radio-label">±3%</div>
                            <div class="radio-desc">민감</div>
                        </div>
                    </div>
                    <div class="radio-option selected" data-value="5">
                        <input type="radio" name="threshold" id="threshold-5" value="5" checked>
                        <div style="flex: 1;">
                            <div class="radio-label">±5%</div>
                            <div class="radio-desc">권장</div>
                        </div>
                    </div>
                    <div class="radio-option" data-value="10">
                        <input type="radio" name="threshold" id="threshold-10" value="10">
                        <div style="flex: 1;">
                            <div class="radio-label">±10%</div>
                            <div class="radio-desc">여유</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="bottom-sheet-footer">
                <button class="modal-btn primary" id="threshold-save-btn">저장</button>
            </div>
        </div>
    </div>

    <!-- Notification Setting Bottom Sheet -->
    <div id="notification-modal" class="bottom-sheet-overlay" style="display: none;">
        <div class="bottom-sheet">
            <div class="bottom-sheet-handle"></div>
            <div class="bottom-sheet-header">
                <h3>알림 설정</h3>
                <button class="close-btn" id="notification-close-btn">×</button>
            </div>
            <div class="bottom-sheet-body">
                <p style="color: var(--text-secondary); font-size: 14px; margin-bottom: 24px;">
                    이 포트폴리오에 대한 알림을 관리합니다.
                </p>
                <div class="notification-options">
                    <div class="settings-item">
                        <span class="settings-label">리밸런싱 알림</span>
                        <label class="toggle">
                            <input type="checkbox" id="notification-rebalance" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="settings-item">
                        <span class="settings-label">가격 변동 알림</span>
                        <label class="toggle">
                            <input type="checkbox" id="notification-price">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>
            </div>
            <div class="bottom-sheet-footer">
                <button class="modal-btn primary" id="notification-save-btn">저장</button>
            </div>
        </div>
    </div>

    <!-- Fixed Bottom Actions -->
    <div class="detail-actions">
        <button class="action-btn secondary" id="detail-add-stock-btn">
            <span class="action-icon">+</span>
            <span>종목 추가</span>
        </button>
        <button class="action-btn primary" id="detail-rebalance-action-btn">
            <span class="action-icon">⚖️</span>
            <span>리밸런싱 분석</span>
        </button>
    </div>
</div>
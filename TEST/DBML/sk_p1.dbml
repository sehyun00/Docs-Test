// 사용자 정보
Table users {
  id integer [primary key, increment]
  email varchar [not null]
  nickname varchar
  bio text // 자기소개
  provider enum ('GOOGLE', 'KAKAO', 'NAVER') // 소셜 제공자(현 구글)
  role enum ('USER', 'ADMIN') // 사용자, 관리자
  profile_image_url varchar
  refresh_token text // 토큰 갱신용
  created_at timestamp // 가입 날짜
  updated_at timestamp // 업데이트 날짜
  membership_type enum ('FREE', 'PRO', 'EXPERT') // 멤버쉽 여부(free, pro, expert 같은 구분을 위해 enum 사용)
  is_verified boolean // 본인인증 여부
  is_suspended boolean [default: false] // 현재 정지 상태
  suspended_until timestamp // 정지 해제 일시
  is_delete boolean [default: false] // 논리적 삭제 여부
  delete_at timestamp // 논리적 삭제 일시
}

// 포트폴리오
Table portfolios {
  id integer [primary key, increment]
  user_id integer [ref: > users.id] // 어떤 사용자의 포트폴리오인지
  name varchar // 포트폴리오명
  description text // 포폴 설명
  account_id integer [ref: - accounts.id] // 한 계좌의 메인으로 설정된 포트폴리오인지
  banner_color varchar [default: '#4CAF93'] // 포트폴리오 배너 색상
  created_at timestamp // 생성 날짜
  updated_at timestamp // 업데이트 날짜
  is_delete boolean [default: false] // 논리적 삭제 여부
  delete_at timestamp // 논리적 삭제 일시
}

// 포트폴리오 내 종목 항목들
Table portfolio_stock_entries {
  id integer [primary key, increment]
  portfolio_id integer [not null, ref: > portfolios.id]
  group varchar // 분류
  ticker varchar [not null] // 주식 ticker
  target_weight decimal // 희망 비중(%)
  created_at timestamp // 생성 날짜
  updated_at timestamp // 업데이트 날짜
  is_delete boolean [default: false] // 논리적 삭제 여부
  delete_at timestamp // 논리적 삭제 일시
}

// 포트폴리오 내 현금 목표 비중
Table portfolio_cash_entries {
  id integer [primary key, increment]
  portfolio_id integer [not null, ref: > portfolios.id]
  currency enum('KRW', 'USD', 'JPY') [not null, default: 'KRW'] // 통화
  target_weight decimal // 희망 비중(%)
  created_at timestamp // 생성 날짜
  updated_at timestamp // 업데이트 날짜
  is_delete boolean [default: false] // 논리적 삭제 여부
  delete_at timestamp // 논리적 삭제 일시
}

// 알림 설정
Table notification_settings {
  id integer [primary key, increment]
  portfolio_id integer [ref: - portfolios.id] // 포트폴리오와 1:1 관계
  is_enabled boolean [default: false]
  alert_cycle enum('WEEKLY', 'MONTHLY') // 알림 주기
  alert_time time // 알림 발송 시간
  threshold_percentage decimal [default: 20.0] // 임계값 (±20%)
  updated_at timestamp
}

// 연동 계좌
Table accounts {
  id integer [primary key, increment]
  user_id integer [ref: > users.id] // 어떤 사용자의 계좌인지
  brokerage_name varchar // 증권사 명
  account_number varchar // 계좌 번호(암호화)
  access_token text // API 접근 토큰
  refresh_token text // 토큰 갱신용
  is_connected boolean [default: false] // 현재 연결 여부
  created_at timestamp
  updated_at timestamp
  is_delete boolean [default: false] // 논리적 삭제 여부
  delete_at timestamp // 논리적 삭제 일시
}

// 계좌 내 종목 항목들
Table account_stock_entries {
  id integer [primary key, increment]
  account_id integer [not null, ref: > accounts.id]
  group varchar // 분류
  ticker varchar [not null] // 주식 ticker
  current_quantity decimal // 현재 수량
  bought_price decimal // 평단가
  currency enum ('KRW', 'USD', 'JPY') [default: 'KRW'] // 거래 통화
  exchange varchar // 거래소
  created_at timestamp // 생성 날짜
  updated_at timestamp // 업데이트 날짜
  is_delete boolean [default: false] // 논리적 삭제 여부
  delete_at timestamp // 논리적 삭제 일시
}

// 계좌 내 실제 현금 잔고
Table account_cash_entries {
  id integer [primary key, increment]
  account_id integer [not null, ref: > accounts.id]
  currency enum('KRW', 'USD', 'JPY') [not null, default: 'KRW'] // 통화
  amount decimal [default: 0] // 실제 보유 금액
  created_at timestamp // 생성 날짜
  updated_at timestamp // 업데이트 날짜
  is_delete boolean [default: false] // 논리적 삭제 여부
  delete_at timestamp // 논리적 삭제 일시
}

// 사용자 설정값
Table settings {
  id integer [primary key, increment]
  user_id integer [ref: - users.id]
  is_notification boolean // 알림 설정 허용
  is_privacy boolean // 개인정보 허용
  is_tutorial_completed boolean // 최초 1회 튜토리얼 가이드 완료 여부
  created_at timestamp // 생성 날짜
  updated_at timestamp // 업데이트 날짜
}

// 알림 스택
Table notifications {
  id integer [primary key, increment]
  user_id integer [ref: > users.id] // 수신 대상자
  notification_type_id integer [ref: > notification_types.id] // 알림 종류
  title varchar [not null] // 알림 제목
  message text [not null] // 알림 본문
  related_entity_id integer [ref: > portfolios.id] // 관련 포트폴리오 ID 등 (클릭 시 이동용)
  is_read boolean [default: false] // 읽음 여부
  created_at timestamp [default: `now()`]
  is_delete boolean [default: false] // 논리적 삭제 여부
  delete_at timestamp // 논리적 삭제 일시
}

// 알림 종류
Table notification_types {
  id integer [primary key, increment]
  code varchar [not null, unique]
  name varchar [not null] // 알림 종류명
  is_active boolean [default: true] // 활성화
  created_at timestamp [default: `now()`] // 생성 날짜
  updated_at timestamp // 업데이트 날짜
}
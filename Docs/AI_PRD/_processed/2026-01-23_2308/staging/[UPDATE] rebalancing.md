---
batch: 2026-01-23_2100
domain: rebalancing
type: update
---
# 리밸런싱(Rebalancing) 분석 고도화

## 1. 개요

Inbox의 `06_rebalancing.md` 요구사항을 반영하여 리밸런싱 분석 화면에 '비용 요약' 정보와 '매매 가이드 복사' 기능을 추가합니다.

## 2. 변경 사항 요약

| 구분          | 항목      | 변경 내용                                 |
| ------------- | --------- | ----------------------------------------- |
| **UI**  | 요약 카드 | 매수/매도/순매수 금액 요약 섹션 추가      |
| **UI**  | 액션      | 거래 정보 '복사하기' 기능 추가            |
| **API** | Response  | 리밸런싱 비용 요약(`summary`) 객체 추가 |

## 3. 상세 스펙 변경

### A. [UI] `specs/ui/rebalancing/check.md`

#### 수정: 레이아웃 & 컴포넌트

'리밸런싱 비용 요약' 카드를 종목 리스트 상단 전이나 하단에 배치합니다.

```markdown
### 1. 요약 카드 (업데이트)

| 요소 | 설명 |
|------|------|
| 총 평가금액 | 전체 포트폴리오 가치 |
| **매도 예상 금액** | 리밸런싱을 위해 팔아야 할 총액 (+) |
| **매수 필요 금액** | 리밸런싱을 위해 사야 할 총액 (-) |
| **순수 필요 자금** | 매수 - 매도 (양수면 추가 입금 필요) |
```

#### 추가: 상호작용 (Interaction)

```markdown
| 액션 | 동작 |
|------|------|
| **[복사] 버튼** | 해당 종목의 매매 가이드 텍스트 복사 (예: "삼성전자 8주 매도") |
```

---

### B. [API] `specs/api/rebalancing/calculate.md`

#### 수정: Response

Client에서 계산할 수도 있지만, 신뢰성을 위해 서버에서 요약 정보를 내려줍니다.

```json
{
  "totalValue": 10000000,
  "needsRebalancing": true,
  "threshold": 5,
  
  // [NEW] 비용 요약 추가
  "summary": {
    "totalSellAmount": 596000,    // 매도 총액
    "totalBuyAmount": 1622500,    // 매수 총액
    "netAmount": 1026500          // 순수 필요 자금 (Buy - Sell)
  },

  "suggestions": [...]
}
```

## 4. AI 분석 및 확인 사항

### 🔍 논리적 검증

- **계산 로직**: `summary` 필드는 `suggestions` 배열을 순회하며 `action`이 `BUY`인 것과 `SELL`인 것을 각각 합산하여 도출합니다.
- **UX 편의성**: 사용자가 일일이 계산하지 않아도 "그래서 얼마 더 넣어야 돼?"를 바로 알 수 있어 유용합니다.

### ❓ 확인 필요 사항

#### 1. 순수 필요 자금(Net Amount) 표시 방식

매도가 매수보다 많아서 현금이 남는 경우는 어떻게 표시할까요?

- [ ] **옵션 A (부호)**: `+`는 필요 자금(입금 필요), `-`는 남는 돈(출금 가능/현금확보) 표기
- [X] **옵션 B (텍스트)**: "추가 필요 자금" vs "예상 현금 확보"로 라벨을 동적으로 변경
- [ ] 기타: ________________

# 종목 검색/추가 페이지 시나리오 (Stock Search)

## 개요

- 포트폴리오에 새 종목 추가
- 실시간 종목 검색 (자동완성)
- 보유 수량 + 목표 비율 설정

## 진입 조건

| 조건 | 동작 |
|------|------|
| 포트폴리오 상세 → + 종목 추가 | 검색 화면 표시 |

## 레이아웃

### 검색 화면

```
┌─────────────────────────────────────┐
│  ←  종목 추가                       │
├─────────────────────────────────────┤
│ ┌─────────────────────────────────┐ │
│ │ 🔍 현대                       X │ │
│ └─────────────────────────────────┘ │
├─────────────────────────────────────┤
│ 현대자동차                          │
│ 005380           ₩186,500  +1.24%  │
│─────────────────────────────────────│
│ 현대모비스                          │
│ 012330           ₩252,000  -0.79%  │
│─────────────────────────────────────│
│ 현대건설                            │
│ 000720           ₩31,450   +2.11%  │
└─────────────────────────────────────┘
```

### 종목 추가 모달

```
┌─────────────────────────────────────┐
│ 현대자동차                      [X] │
├─────────────────────────────────────┤
│ ₩186,500                   +1.24%  │
├─────────────────────────────────────┤
│ 보유 수량                           │
│         [-]  10주  [+]              │
│         예상 금액: ₩1,865,000       │
├─────────────────────────────────────┤
│ 목표 비율                    10%   │
│ ○━━━━━━●━━━━━━━━━━━━━━○           │
├─────────────────────────────────────┤
│ 기존 종목: 90%                      │
│ + 현재: 10%                         │
│ 합계: 100% ✓                       │
├─────────────────────────────────────┤
│ [취소]              [추가]          │
└─────────────────────────────────────┘
```

## 컴포넌트

### 검색 필드

| 속성 | 값 |
|------|-----|
| 플레이스홀더 | "종목명 또는 코드 검색" |
| 디바운스 | 300ms |
| 최소 검색어 | 1자 |
| 최대 결과 | 10개 |

### 검색 결과 항목

| 요소 | 설명 |
|------|------|
| 종목명 | 좌측 상단 |
| 종목코드 | 좌측 하단 |
| 현재가 | 우측 상단 |
| 등락률 | 우측 하단 (+/-%, 색상) |
| 이미 보유 배지 | [이미 보유 중] |

### 추가 모달

| 요소 | 설명 |
|------|------|
| 수량 입력 | [-] [수량] [+] (정수, 1주 이상) |
| 예상 금액 | 현재가 × 수량 |
| 목표 비율 슬라이더 | 0~100% |
| 비율 합계 | 기존 + 현재 = 합계 |

## 상호작용

| 액션 | 동작 |
|------|------|
| 검색어 입력 | 실시간 자동완성 (300ms 디바운스) |
| X 버튼 | 검색어 초기화 |
| 검색 결과 탭 | 종목 추가 모달 열기 |
| 이미 보유 종목 탭 | 토스트 "이미 보유 중인 종목입니다" |
| 수량 +/- | 1주 단위 증감 |
| 슬라이더 드래그 | 목표 비율 조정 |
| 추가 버튼 | 저장 → 상세 화면 복귀 |

## 상태

| 상태 | UI |
|------|-----|
| Default (빈 검색창) | 최근 검색, 인기 종목 표시 |
| Typing | 검색 결과 로딩 |
| No Results | "검색 결과가 없습니다" |
| 수량 0 | 추가 버튼 비활성화 |
| 비율 ≤100% | 추가 버튼 초록색 |
| 비율 >100% | 경고 UI + 추가 버튼 빨간색 (추가 허용) |

## 엣지 케이스

| 상황 | 처리 |
|------|------|
| 검색 결과 없음 | "검색 결과가 없습니다" + 안내 |
| 네트워크 오류 | "검색 실패. 다시 시도해주세요" |
| 수량 0 입력 | 추가 버튼 비활성화 |
| 이미 보유 종목 | 배지 + 토스트 알림 |
| 비율 합계 초과 | 경고 UI + 추가 허용 |
| 거래정지 종목 | 경고 표시 (추가는 허용) |

## 관련 스펙

- API: `../../specs/api/stock/search.md`
- API: `../../specs/api/stock/add.md`
- UI: `../../specs/ui/stock/add.md`
- 이전 화면: `04_portfolio_detail.md`
